<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Buscador de Repos</title>
    <script src= "https://unpkg.com/react@16/umd/react.production.min.js"></script>
    <script src= "https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
    <!-- Load Babel Compiler -->
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body style="margin-top: 200px; text-align: center;">
    <div>
        <div id="root"></div>
        <!--https://api.github.com/repos/microsoft/vscode/pulls/comments asi checamos los comentarios >_<-->
    <script type="text/babel">
    
    class App extends React.Component {
  constructor() {
    super();
    this.state = {
      busquedaGit: null,
      repos_array : [],
      Addhtml : null,
      tr : ""
    };
    
    this.buscar = this.buscar.bind(this);
    this.handleChange = this.handleChange.bind(this);
  }
  
  handleChange({ target }) {
    this.setState({
      [target.name]: target.value
    });
  }

  buscar() {
                this.setState({
             Addhtml: '',
             repos_array:[],
             tr : ""
            });
    console.log( this.state.busquedaGit );
    axios.get('backend.php', {
    params: {
      q: this.state.busquedaGit
    }
  })
      .then(res => {
        const repos = res.data;
        this.setState({ repos_array:repos.items });
        let table  = [];
        console.log(this.state.repos_array);
        let content = this.state.repos_array.map( repo=> { this.setState({ tr: this.state.tr+'<tr><td>'+repo.id+'</td><td>'+repo.name+'</td></tr>' })});
        console.log(content);
            table.push(`<table>`);
            table.push(this.state.tr);
            console.log(this.state.tr);
            table.push(`</table>`);
            this.setState({
             Addhtml: table.join("")
            });
      })
  }
  
  render() {
     return <div>

      <input 
        type="text" 
        name="busquedaGit" 
        placeholder="Â¿Que quieres bucar?" 
        value={ this.state.busquedaGit }
        onChange={ this.handleChange } 
      />
      
      <button value="Send" onClick={ this.buscar }>Buscar</button>
 <div id="tabla-resultados" dangerouslySetInnerHTML={{__html: this.state.Addhtml}}></div>
       </div>
  }
}

ReactDOM.render(<App />, document.getElementById('root'));
    </script>
    </div>
</body>
</html>